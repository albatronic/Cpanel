{# FILTRO AVANZADO _global/filtroAvanzado.html.twig #}

<div id="filtroAvanzado" title="Filtro Avanzado" class="FiltrosAdicionales">

{% set i = 0 %}
{% for key,value in filter.aditional %}
    
    {# SE MUESTRAN SOLO LAS COLUMNAS QUE SON VISIBLES SEGUN LAS VARIABLES DE ENTORNO #}
    {# ADEM√ÅS EL CAPTION SE QUE SE MUESTRA NO ES EL DEFINIDO CON EL CONFIG.YML SINO #}
    {# EL INDICADO EN LA VARIABLE DE ENTORNO #}
    {% if (values.varEnvMod.columns[value.field].visible) or (user.IdPerfil == 1) %}
    
        {% set i = i+1 %}
        {% if filter.valuesSelected[i] %}
            {% set valor = filter.valuesSelected[i] %}
        {% else %}
            {% set valor = value.default %}
        {% endif %}

        <div class="FiltroAdicional">
            <div style="float: left; width: 140px; margin-right: 3px;">&nbsp;&nbsp;{{values.varEnvMod.columns[value.field].caption}}:</div>

            <div style="float: left; height: 25px;">
            {% if value.type == 'select' %}
                <input name="filter[columnsSelected][{{i}}]" value="{{value.field}}" type="hidden"/>
                <select name="filter[valuesSelected][{{i}}]" id="filter_valuesSelected_{{i}}" {{ value.event }} style="width: 120px;">
                    {% for objeto in value.values  %}
                    <option value="{{ objeto.Id }}" {% if objeto.Id == valor %} SELECTED {% endif %}>{{ objeto.Value }}</option>
                    {% endfor %}
                </select>
            {% endif %}

            {% if value.type == 'input' %}
                <input name="filter[columnsSelected][{{i}}]" value="{{value.field}}" type="hidden"/>
                <input name="filter[valuesSelected][{{i}}]" id="filter_valuesSelected_{{i}}" value ="{{ valor }}" type="text" size="10" {{ value.event }}/>
            {% endif %}

            {% if value.type == 'range' %}
                <input name="filter[columnsSelected][{{i}}]" value="{{value.field}}" type="hidden"/>
                {% if value.data_type == 'date' %}
                    {{ macro.fecha(none,none,"filter[valuesSelected]["~i~"]","filter_valuesSelected_"~i,valor) }}
                {% else %}
                    <input name="filter[valuesSelected][{{i}}]" id="filter_valuesSelected_{{i}}" value ="{{ valor }}" type="text" size="10" {{ value.event }}/>
                {% endif %}
            {% endif %}

            {% if value.type == 'check' %}
                <input name="filter[columnsSelected][{{i}}]" value="{{value.field}}" type="hidden"/>
                <input name="filter[valuesSelected][{{i}}]" id="filter_valuesSelected_{{i}}"
                 {% if  valor != '' %}
                    {% if  valor == '1' %}
                       checked="checked"
                    {% endif %}
                 {%else%}
                    {% if  value.default == 'on' %}
                       checked="checked"
                    {% endif %}
                 {% endif %}
                       type="checkbox" {{ value.event }}/>
            {% endif %}
            </div>
        </div>
    {% endif %}
    
{% endfor %}

<div style='clear:both'></div>

<div style="margin-top: 5px; margin-bottom: 10px; margin-left:43px; width: 290px;">
<input class="FiltrosAdicionalesComando" type="buttom" value="Consultar"
      onclick="
          $('#div_listado').html('<div class=ListadoAnimation><img src={{app.path}}/images/loadingAnimation.gif /></div>');
          $('#filtroAvanzado').dialog('close');
          $('#filtro').submit();"
/>
</div>
</div>